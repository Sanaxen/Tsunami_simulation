<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
 <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
 <link rel="Stylesheet" rev="Stylesheet" href="../../css/landserf.css" media="All" />

<!-- LandSerf Header -->

 <title>LandScript - Example Scripts</title>
 <meta name="description" content="LandSerf scripting examples" />
 <meta name="keywords" content="LandSerf, GIS, DEM, Java, scripting, map algebra, LandScript, programming, Terrain modelling" />
</head>

<body>
<div id="header">
 <a href="../../../index.html">
  <img src="../../images/landserfText.gif" width="304" height="57" alt="Go to LandSerf documentation" />
  <span id="lsicon">
   <img src="../../images/iconTitle.gif" width="57" height="57" alt="Go to Landserf documentation" />
  </span>
 </a>
 <br />

 <div id="breadcrumbs">
  <span id="currentLocation">Example</span>       |
  <a href="./index.html">Examples index</a> |
  <a href="../index.html">LandScript</a> |
  <a href="../../index.html">LandSerf 2.3 Documentation</a> |
  <a href="http://www.landserf.org">landserf.org</a>
 </div>
</div>

<div id="container">

 <!-- End of header -->

<h1>Creating Ancillary Map Information</h1>

<h2>Creating a map legend</h2>

<p>
 This example combines a simple raster and vector map to create a legend for a spatial object.
 The object is first loaded (line 15) and its colour table saved as a temporary file (line 22).
 A long thin raster, whose dimensions are determined in lines 8 and 9, is then created with continuous
 values that range from the object's minimum to maximum values (lines 25 and 30). By associating the
 spatial object's colour table with this new raster (line 67), the raster can be used to represent
 the colours as a colour bar.
</p>

<p>
 A simple vector map is used to display the legend text. Each item of text is associated with a vector
 point (lines 35-40 and lines 55-60) with an attribute value containing the text to display (lines 41-45 and 61-65).
 Border spacing around the legend is created by adding some unlabeled points to the vector at the corner points
 (lines 35-36 and lines 55-56).
</p>

<p>
 Finally, the labelling style is set (lines 75-78) and combined with the raster colour bar (line 81).
</p>

<table border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">

<!-- ~~~~ Created using jFormat V2.5 ~~~~ -->
<table cellpadding="0" cellspacing="0"><tr>
<td valign="top">
<pre class="numbering">
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
</pre>
</td>
<td valign="top">
<pre class="jSource">
<span class="jComment"># Script to create a simple legend from a raster</span>
<span class="jKeyword">version</span>(1.0); 
 
<span class="jComment"># Change the directory below to correspond to your file location.</span>
baseDir = &quot;<span class="jQuote">c:/Program Files/LandSerf/data/landscriptExamples/</span>&quot;;

<span class="jComment"># Dimensions of colour bar in pixels.</span>
longside  = 260;
shortside = 30;
fontSize  = 15;
border    = 20;
direction = &quot;<span class="jQuote">horizontal</span>&quot;;

<span class="jComment"># Open the source object for which legend is to be produced.</span>
map = open(baseDir&amp;&quot;<span class="jQuote">dem.srf</span>&quot;);

<span class="jComment"># Find attribute range and save colour table to a file.</span>
minVal = <span class="jKeyword">info</span>(map,&quot;<span class="jQuote">min</span>&quot;);
maxVal = <span class="jKeyword">info</span>(map,&quot;<span class="jQuote">max</span>&quot;);
range = maxVal-minVal;
legendTitle = <span class="jKeyword">info</span>(map,&quot;<span class="jQuote">title</span>&quot;);
<span class="jKeyword">save</span>(map,baseDir&amp;&quot;<span class="jQuote">temp.ctb</span>&quot;,&quot;<span class="jQuote">colourtable</span>&quot;);

<span class="jComment"># Create a thin rectangular raster to show colour table</span>
colours = <span class="jKeyword">newraster</span>(0,0,1,1,shortside,longside);

<span class="jKeyword">if</span> (<span class="jKeyword">compare</span>(direction,&quot;<span class="jQuote">vertical</span>&quot;)==0);
{
    <span class="jComment"># This is the vertical colour bar.</span>
    colours = <span class="jKeyword">newraster</span>(0,0,1,1,longside,shortside);
    colours = maxVal - range*<span class="jKeyword">row</span>/longside;
    <span class="jKeyword">vectorstyle</span>(&quot;<span class="jQuote">labelposition</span>&quot;,&quot;<span class="jQuote">east</span>&quot;);

    <span class="jComment"># Create file representing vector map with legend annotation</span>
    <span class="jKeyword">echo</span>(-border&amp;&quot;<span class="jQuote"> </span>&quot;&amp; -border&amp;&quot;<span class="jQuote"> 0\n</span>&quot;&amp;
         longside+border &amp;&quot;<span class="jQuote"> </span>&quot;&amp;longside+border&amp;&quot;<span class="jQuote"> 0\n</span>&quot;&amp;
         shortside+fontSize*0.2 &amp;&quot;<span class="jQuote"> </span>&quot;&amp;longside/2&amp;&quot;<span class="jQuote"> 1\n</span>&quot;&amp;
         shortside+fontSize*0.2 &amp;&quot;<span class="jQuote"> </span>&quot;&amp;fontSize*0.4&amp;&quot;<span class="jQuote"> 2\n</span>&quot;&amp;
         shortside+fontSize*0.2 &amp;&quot;<span class="jQuote"> </span>&quot;&amp;longside-fontSize*0.2&amp;&quot;<span class="jQuote"> 3\n</span>&quot;,    
         baseDir&amp;&quot;<span class="jQuote">temp.txt</span>&quot;);
    <span class="jKeyword">echo</span>(&quot;<span class="jQuote"># ID Label\n</span>&quot;&amp;
         &quot;<span class="jQuote">1 </span>&quot;&amp;<span class="jKeyword">quote</span>(legendTitle)&amp;&quot;<span class="jQuote">\n</span>&quot;&amp;
         &quot;<span class="jQuote">2 </span>&quot;&amp;<span class="jKeyword">quote</span>(<span class="jKeyword">round</span>(minVal))&amp;&quot;<span class="jQuote">\n</span>&quot;&amp;
         &quot;<span class="jQuote">3 </span>&quot;&amp;<span class="jKeyword">quote</span>(<span class="jKeyword">round</span>(maxVal)),
         baseDir&amp;&quot;<span class="jQuote">temp.atr</span>&quot;);
}

<span class="jKeyword">if</span> (<span class="jKeyword">compare</span>(direction,&quot;<span class="jQuote">vertical</span>&quot;)!=0);
{
    <span class="jComment"># This is the horizontal colour bar.</span>
    colours = minVal +range*<span class="jKeyword">col</span>/longside;
    <span class="jKeyword">vectorstyle</span>(&quot;<span class="jQuote">labelposition</span>&quot;,&quot;<span class="jQuote">north</span>&quot;);

    <span class="jComment"># Create file representing vector map with legend annotation</span>
    <span class="jKeyword">echo</span>(-border&amp;&quot;<span class="jQuote"> </span>&quot;&amp; -border&amp;&quot;<span class="jQuote"> 0\n</span>&quot;&amp;
         longside+border &amp;&quot;<span class="jQuote"> </span>&quot;&amp;shortside+border&amp;&quot;<span class="jQuote"> 0\n</span>&quot;&amp;
         longside/2 &amp;&quot;<span class="jQuote"> </span>&quot;&amp;shortside+fontSize*0.2&amp;&quot;<span class="jQuote"> 1\n</span>&quot;&amp;
         &quot;<span class="jQuote">0 </span>&quot;&amp;-fontSize&amp;&quot;<span class="jQuote"> 2\n</span>&quot;&amp;
         longside&amp;&quot;<span class="jQuote"> </span>&quot;&amp; -fontSize &amp; &quot;<span class="jQuote"> 3</span>&quot;,    
         baseDir&amp;&quot;<span class="jQuote">temp.txt</span>&quot;);
    <span class="jKeyword">echo</span>(&quot;<span class="jQuote"># ID Label\n</span>&quot;&amp;
         &quot;<span class="jQuote">1 </span>&quot;&amp;<span class="jKeyword">quote</span>(legendTitle)&amp;&quot;<span class="jQuote">\n</span>&quot;&amp;
         &quot;<span class="jQuote">2 </span>&quot;&amp;<span class="jKeyword">quote</span>(&quot;<span class="jQuote">   </span>&quot;&amp;<span class="jKeyword">round</span>(minVal))&amp;&quot;<span class="jQuote">\n</span>&quot;&amp;
         &quot;<span class="jQuote">3 </span>&quot;&amp;<span class="jKeyword">quote</span>(<span class="jKeyword">round</span>(maxVal)&amp;&quot;<span class="jQuote">   </span>&quot;),
         baseDir&amp;&quot;<span class="jQuote">temp.atr</span>&quot;);
}
<span class="jKeyword">colouredit</span>(colours,&quot;<span class="jQuote">file</span>&quot;,baseDir&amp;&quot;<span class="jQuote">temp.ctb</span>&quot;);

<span class="jComment"># Open the vector file</span>
annotation = open(baseDir&amp;&quot;<span class="jQuote">temp.txt</span>&quot;,&quot;<span class="jQuote">points</span>&quot;);
<span class="jKeyword">edit</span>(annotation,&quot;<span class="jQuote">attributes</span>&quot;,baseDir&amp;&quot;<span class="jQuote">temp.atr</span>&quot;);
<span class="jKeyword">edit</span>(annotation,&quot;<span class="jQuote">attCol</span>&quot;,2);

<span class="jComment"># Set the annotation drawing style.</span>
<span class="jKeyword">vectorstyle</span>(&quot;<span class="jQuote">pointsize</span>&quot;,0.1);
<span class="jKeyword">vectorstyle</span>(&quot;<span class="jQuote">showlabels</span>&quot;,&quot;<span class="jQuote">true</span>&quot;);
<span class="jKeyword">vectorstyle</span>(&quot;<span class="jQuote">labelsize</span>&quot;,fontSize);
<span class="jKeyword">vectorstyle</span>(&quot;<span class="jQuote">labelbackground</span>&quot;,&quot;<span class="jQuote">255 0</span>&quot;);

<span class="jComment"># Draw the colour bar, title and key.</span>
<span class="jKeyword">draw</span>(baseDir&amp;&quot;<span class="jQuote">legend.png</span>&quot;,colours,&quot;<span class="jQuote">null</span>&quot;,annotation);
</pre>
</td></tr></table>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

</td><td valign="top">
<code>legend.png</code> (direction set to 'vertical'):<br /><br />
<img src="images/legendVertical.png" width="300" height="300" alt="legend.png (vertical)" /><br /><br /><br /><br />
<code>legend.png</code> (direction set to 'horizontal'):<br /><br />
<img src="images/legendHorizontal.png" width="300" height="70" alt="legend.png (horizontal)" />
</tr></table>



 <!-- Footer area -->
 <div id="footer">
  <div id="lastModified">Last Modified, 21st April, 2009</div>
 </div>

</div> <!-- End of container area -->
</body>
</html>