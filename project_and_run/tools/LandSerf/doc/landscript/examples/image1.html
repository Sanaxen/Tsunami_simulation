<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
 <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
 <link rel="Stylesheet" rev="Stylesheet" href="../../css/landserf.css" media="All" />

<!-- LandSerf Header -->

 <title>LandScript - Example Scripts</title>
 <meta name="description" content="LandSerf scripting examples" />
 <meta name="keywords" content="LandSerf, GIS, DEM, Java, scripting, map algebra, LandScript, programming, Terrain modelling" />
</head>

<body>
<div id="header">
 <a href="../../../index.html">
  <img src="../../images/landserfText.gif" width="304" height="57" alt="Go to LandSerf documentation" />
  <span id="lsicon">
   <img src="../../images/iconTitle.gif" width="57" height="57" alt="Go to Landserf documentation" />
  </span>
 </a>
 <br />

 <div id="breadcrumbs">
  <span id="currentLocation">Example</span>       |
  <a href="./index.html">Examples index</a> |
  <a href="../index.html">LandScript</a> |
  <a href="../../index.html">LandSerf 2.3 Documentation</a> |
  <a href="http://www.landserf.org">landserf.org</a>
 </div>
</div>

<div id="container">

 <!-- End of header -->

<h1>Processing Colour Components</h1>

<h2>Splitting a raster into 3 colour components</h2>


<table border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">

<!-- ~~~~ Created using jFormat V2.5 ~~~~ -->
<table cellpadding="0" cellspacing="0"><tr>
<td valign="top">
<pre class="numbering">
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre>
</td>
<td valign="top">
<pre class="jSource">
<span class="jComment"># Extracts red, green and blue components from a raster</span>
<span class="jKeyword">version</span>(1.0);

<span class="jComment"># Change the directory below to correspond to your file location.</span>
baseDir = &quot;<span class="jQuote">c:/Program Files/LandSerf/data/landscriptExamples/</span>&quot;;

<span class="jComment"># Open image file.</span>
image = <span class="jKeyword">open</span>(baseDir&amp;&quot;<span class="jQuote">photo.srf</span>&quot;);

<span class="jComment"># Create a new raster to store the colour components</span>
colourComponent = <span class="jKeyword">new</span>(image);
<span class="jKeyword">edit</span>(colourComponent,&quot;<span class="jQuote">type</span>&quot;,&quot;<span class="jQuote">other</span>&quot;);

<span class="jComment"># Extract the three colour components and save the rasters.</span>
colourComponent = <span class="jKeyword">red</span>(image);
<span class="jKeyword">colouredit</span>(colourComponent,&quot;<span class="jQuote">rules</span>&quot;,&quot;<span class="jQuote">0 0, 255 255 0 0</span>&quot;);
<span class="jKeyword">save</span>(colourComponent,baseDir&amp;&quot;<span class="jQuote">redImage.srf</span>&quot;);

colourComponent = <span class="jKeyword">green</span>(image);
<span class="jKeyword">colouredit</span>(colourComponent,&quot;<span class="jQuote">rules</span>&quot;,&quot;<span class="jQuote">0 0, 255 0 255 0</span>&quot;);
<span class="jKeyword">save</span>(colourComponent,baseDir&amp;&quot;<span class="jQuote">greenImage.srf</span>&quot;);

colourComponent = <span class="jKeyword">blue</span>(image);
<span class="jKeyword">colouredit</span>(colourComponent,&quot;<span class="jQuote">rules</span>&quot;,&quot;<span class="jQuote">0 0, 255 0 0 255</span>&quot;);
<span class="jKeyword">save</span>(colourComponent,baseDir&amp;&quot;<span class="jQuote">blueImage.srf</span>&quot;);
</pre>
</td></tr></table>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

</td><td valign="top">
<code>photo.srf</code>:<br /> 
<img src="images/photo.jpg" width="300" height="373" alt="photo.srf" /><br /><br />
<code>redImage.srf</code>, <code>greenImage.srf</code>, <code>blueImage.srf</code>:<br /> 
<img src="images/photoRGB.jpg" width="300" height="123" alt="R G B components" /><br />
</tr></table>

<h2>Creating a colour composite</h2>

<!-- ~~~~ Created using jFormat V2.5 ~~~~ -->
<table cellpadding="0" cellspacing="0"><tr>
<td valign="top">
<pre class="numbering">
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre>
</td>
<td valign="top">
<pre class="jSource">
<span class="jComment"># Combines three colour component rasters to create a single colour composite.</span>
<span class="jKeyword">version</span>(1.0);

<span class="jComment"># Change the directory below to correspond to your file location.</span>
baseDir = &quot;<span class="jQuote">c:/Program Files/LandSerf/data/landscriptExamples/</span>&quot;;

<span class="jComment"># Open image file.</span>
redImage = <span class="jKeyword">open</span>(baseDir&amp;&quot;<span class="jQuote">redImage.srf</span>&quot;);
grnImage = <span class="jKeyword">open</span>(baseDir&amp;&quot;<span class="jQuote">greenImage.srf</span>&quot;);
bluImage = <span class="jKeyword">open</span>(baseDir&amp;&quot;<span class="jQuote">blueImage.srf</span>&quot;);

<span class="jComment"># Create and save a new raster storing colour composite</span>
composite = <span class="jKeyword">new</span>(redImage);
<span class="jKeyword">edit</span>(composite,&quot;<span class="jQuote">type</span>&quot;,&quot;<span class="jQuote">image</span>&quot;);
<span class="jKeyword">colouredit</span>(composite,&quot;<span class="jQuote">raw</span>&quot;);

composite = <span class="jKeyword">rgb</span>(redImage,grnImage,bluImage);
<span class="jKeyword">save</span>(composite,baseDir&amp;&quot;<span class="jQuote">compositeImage.srf</span>&quot;);
</pre>
</td></tr></table>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~ -->


<h2>Converting a colour raster to greyscale</h2>


<table border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">

<!-- ~~~~ Created using jFormat V2.5 ~~~~ -->
<table cellpadding="0" cellspacing="0"><tr>
<td valign="top">
<pre class="numbering">
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre>
</td>
<td valign="top">
<pre class="jSource">
<span class="jComment"># Creates a greyscale version of a raster using the formula</span>
<span class="jComment"># greyLev = 0.3R + 0.59G + 0.11B</span>
<span class="jKeyword">version</span>(1.0);

<span class="jComment"># Change the directory below to correspond to your file location.</span>
baseDir = &quot;<span class="jQuote">c:/Program Files/LandSerf/data/landscriptExamples/</span>&quot;;

<span class="jComment"># Open image file.</span>
image = <span class="jKeyword">open</span>(baseDir&amp;&quot;<span class="jQuote">photo.srf</span>&quot;);

<span class="jComment"># Create a new raster to store the grey level values</span>
greyImage = <span class="jKeyword">new</span>(image);
<span class="jKeyword">edit</span>(greyImage,&quot;<span class="jQuote">type</span>&quot;,&quot;<span class="jQuote">other</span>&quot;);
<span class="jKeyword">colouredit</span>(greyImage,&quot;<span class="jQuote">rules</span>&quot;,&quot;<span class="jQuote">0 0, 255 255</span>&quot;);

<span class="jComment"># Do the conversion and save the raster.</span>
greyImage = 0.30*<span class="jKeyword">red</span>(image) + 0.59*<span class="jKeyword">green</span>(image) + 0.11*<span class="jKeyword">blue</span>(image);
<span class="jKeyword">save</span>(greyImage,baseDir&amp;&quot;<span class="jQuote">greyImage.srf</span>&quot;);
</pre>
</td></tr></table>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

</td><td valign="top">
<code>greyImage.srf</code>:<br /> 
<img src="images/photoGrey.jpg" width="300" height="373" alt="greyImage.srf" />
</tr></table>


<h2>Extracting green pixels from a scanned raster map</h2>

<p>
 This example looks for greenish pixels by comparing the R,G and B values for each raster cell. If a pixel is
 found to be green it is labeled as vegetation (<code>1</code>), otherwise  it is labeled as white background 
 (<code>0</code>);
</p>

<table border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">


<!-- ~~~~ Created using jFormat V2.5 ~~~~ -->
<table cellpadding="0" cellspacing="0"><tr>
<td valign="top">
<pre class="numbering">
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre>
</td>
<td valign="top">
<pre class="jSource">
<span class="jComment"># Extracts green components from an image</span><i> </i>
<span class="jKeyword">version</span>(1.0);<i> </i>
<i> </i>
<span class="jComment"># Change the directory below to correspond to your file location.</span><i> </i>
baseDir = &quot;<span class="jQuote">c:/Program Files/LandSerf/data/landscriptExamples/</span>&quot;;<i> </i>
<i> </i>
<span class="jComment"># Open image file.</span><i> </i>
image = <span class="jKeyword">open</span>(baseDir&amp;&quot;<span class="jQuote">topoMap.srf</span>&quot;);<i> </i>
<i> </i>
<span class="jComment"># Extract the greenish pixels</span><i> </i>
image = <span class="jKeyword">ifelse</span>((<span class="jKeyword">green</span>(image) &gt; <span class="jKeyword">blue</span>(image)) <span class="jKeyword">and</span> <i> </i>
               (<span class="jKeyword">green</span>(image) &gt; <span class="jKeyword">red</span>(image))  <span class="jKeyword">and</span> <i> </i>
               (<span class="jKeyword">green</span>(image)/(<span class="jKeyword">red</span>(image)+<span class="jKeyword">blue</span>(image)) &gt; 0.6),1,0);<i> </i>
<i> </i>
<span class="jComment"># Pass a 5x5 median filter over surface to remove isolated patches.</span><i> </i>
veg = <span class="jKeyword">new</span>(image);<i> </i>
veg = <span class="jKeyword">median</span>(image[-2,-2],image[-2,-1],image[-2,0],image[-2,1],image[-2,2],<i> </i>
             image[-1,-2],image[-1,-1],image[-1,0],image[-1,1],image[-1,2],<i> </i>
             image[ 0,-2],image[ 0,-1],image[ 0,0],image[ 0,1],image[ 0,2],<i> </i>
             image[ 1,-2],image[ 1,-1],image[ 1,0],image[ 1,1],image[ 1,2],<i> </i>
             image[ 2,-2],image[ 2,-1],image[ 2,0],image[ 2,1],image[ 2,2]);<i> </i>
<i> </i>
<span class="jComment"># Add metadata and save the green raster.</span><i> </i>
<span class="jKeyword">colouredit</span>(veg,&quot;<span class="jQuote">rules</span>&quot;,&quot;<span class="jQuote">0 255 255 255, 1 0 200 0</span>&quot;);<i> </i>
<span class="jKeyword">edit</span>(veg,&quot;<span class="jQuote">type</span>&quot;,&quot;<span class="jQuote">other</span>&quot;);<i> </i>
<span class="jKeyword">save</span>(veg,baseDir&amp;&quot;<span class="jQuote">veg.srf</span>&quot;);<i> </i>
</pre>
</td></tr></table>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

</td><td valign="top">
<code>topoMap.srf</code>:<br /> 
<img src="images/topomap.jpg" width="300" height="306" alt="topoMap.srf" /><br />
<code>veg.srf</code>:<br /> 
<img src="images/veg.png" width="300" height="306" alt="veg.srf" />
</tr></table>


 <!-- Footer area -->
 <div id="footer">
  <div id="lastModified">Last Modified, 21st April, 2009</div>
 </div>

</div> <!-- End of container area -->
</body>
</html>