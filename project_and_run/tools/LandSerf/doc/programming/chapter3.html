<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
 <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
 <link rel="Stylesheet" rev="Stylesheet" href="../css/landserf.css" media="All" />

<!-- LandSerf Header -->

 <title>LandSerf Programming Guide  - 3. Manipulating Vector Maps</title>
 <meta name="description" content="LandSerf Programming Guide" />
 <meta name="keywords" content="LandSerf, GIS, DEM, Java, programming, Terrain modelling" />
</head>

<body>
<div id="header">
 <a href="../../index.html">
  <img src="../images/landserfText.gif" width="304" height="57" alt="Go to LandSerf documentation" />
  <span id="lsicon">
   <img src="../images/iconTitle.gif" width="57" height="57" alt="Go to Landserf documentation" />
  </span>
 </a>
 <br />

 <div id="breadcrumbs">
  <span id="currentLocation">Chapter 3</span>       |
  <a href="index.html">Programming Guide</a> |
  <a href="../../index.html">LandSerf 2.3 Documentation</a> |
  <a href="http://www.landserf.org">landserf.org</a>
 </div>
</div>

<div id="container">

 <!-- End of header -->

<h1>Chapter 3. Manipulating Vector Maps</h1>

<div class="highlightbox">
By the end of this chapter you will be able to:
<br /><br />
<ul>
 <li>Understand the relationship between a <code>VectorMap</code> and <code>GISVector</code>. <br /><br /></li>
 <li>Create <code>GISVector</code>s from sets of geometric coordinates.<br /><br /></li>
 <li>Create a vector map, add <code>GISVector</code>s to it and associate it with metadata<br /><br /></li>
 <li>Perform simple processing operations on vector maps<br /><br /></li> 
</ul>
</div>
<div class="columnbreak"></div>


<h2>3.1 The structure of a vector map</h2>

<p>
 In contrast with raster maps, vector maps are used to represent collections discrete spatial objects with
 known boundaries. Those objects may be points in space, lines, or areas defined by linear boundaries. A
 vector map may contain any number of these objects that may be separate from each other, joined, or overlapping.
 <br /><br />
<img src="images/figure3.1.png" width="600" height="333" align="bottom" alt="Simple point, line and area features and their vector map representation" />
<span class="caption">Simple point, line and area features and their vector map representation.</span>
</p>

<p>
 An individual vector object (such as the red line, blue line, yellow or green rectangle or point above) is represented by 
 the class <code>GISVector</code>. This stores the geometry of the object as a series of (x,y) coordinate pairs. Implicit in this
 model is that lines and area boundaries are defined by joining consecutive pairs with straight line segments. A <code>GISVector</code>
 also inherits <code>SpatialObject</code> just as the <code>RasterMap</code> class does. It therefore has methods for defining its bounds,
 performing simple spatial comparisons, and manipulating its attribute(s). The <code>VectorMap</code> class simply assembles a collection
 of the <code>GISVector</code>s into a single object that itself has bounds and other metadata attached to it.
</p>

<h2>3.2 Creating a simple vector map</h2>

<p>
 Creating a vector map is a simple process and just requires calling one of <a href="api/jwo/landserf/structure/VectorMap.html" target="_blank"><code>VectorMap</code></a>'s constructors. Like the <a href="api/jwo/landserf/structure/RasterMap.html" target="_blank"><code>RasterMap</code></a>
 class, you can define the bounds of the object at the point of creation, copy the contents of an existing spatial object, or simply
 create an empty vector map. Unlike rasters, it is more common for vector maps to grow and shrink as objects are added and removed, so
 it is quite usual initially to create an empty vector map object:
 <br /><br />
 <code>VectorMap myVectorMap = new VectorMap();</code>
</p>

<p>
 The geometry of an individual object within a vector map is stored in a <a href="api/jwo/landserf/structure/GISVector.html" target="_blank"><code>GISVector</code></a> object. The object also stores its
 type - one of <code>GISVector.POINT</code>, <code>GISVector.LINE</code> or <code>GISVector.AREA</code>, as well as its attribute
 value. These can all be set in <code>GISVector</code>'s constructor, or added later using an appropriate method.
</p>

<p>
 The class below shows how some simple vector objects may be created and added to a vector map which is then saved to disk.
</p>

<!-- ~~~~ Created using jFormat V2.4.1 ~~~~ -->
<table cellpadding="0" cellspacing="0"><tr>
<td valign="top">
<pre class="numbering">
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
</pre>
</td>
<td valign="top">
<pre class="jSource">
<span class="jKeyword">import</span> jwo.landserf.structure.*;   <span class="jComment">// For spatial objects.</span>
<span class="jKeyword">import</span> jwo.landserf.process.io.*;  <span class="jComment">// For file handling.</span>

<span class="jComment">// **********************************************************</span>
<span class="jDocComment">/** Creates a simple vector map containing some GISVectors.
  * Demonstrates how vector maps can be created and written.
  * @author Jo Wood
  * @version 1.1, 16th October, 2007
  */</span>
<span class="jComment">// **********************************************************</span>

<span class="jKeyword">public</span> <span class="jKeyword">class</span> SimpleVectorMap
{
    <span class="jComment">//------------------ Starter Method -----------------</span>
    
    <span class="jKeyword">public</span> <span class="jKeyword">static</span> <span class="jPrimitive">void</span> main(String[] args)
    {
        <span class="jKeyword">new</span> SimpleVectorMap();
    }

    <span class="jComment">//------------------- Constructor -------------------</span>

    <span class="jKeyword">public</span> SimpleVectorMap()
    {
        <span class="jComment">// Create an empty vector map, then place some GISVectors within it.</span>
        VectorMap vectorMap = <span class="jKeyword">new</span> VectorMap();
        
        <span class="jPrimitive">float</span> riverX[] = {2,1,4,7,10,12,11};
        <span class="jPrimitive">float</span> riverY[] = {2,4,5,3, 4, 7,11};
        
        GISVector road = <span class="jKeyword">new</span> GISVector(riverX,riverY,SpatialModel.LINE,10);
        vectorMap.add(road);
        
        <span class="jPrimitive">float</span> buildingX[] = {6,10,11,10,9,7};
        <span class="jPrimitive">float</span> buildingY[] = {8,10, 7, 5,7,6};
        
        GISVector building = <span class="jKeyword">new</span> GISVector(buildingX,buildingY,SpatialModel.AREA,20);
        vectorMap.add(building);
        
        GISVector pump = <span class="jKeyword">new</span> GISVector(8,5,30);
        vectorMap.add(pump);     
                
        <span class="jComment">// Add some simple metadata.</span>
        Header header = <span class="jKeyword">new</span> Header(&quot;<span class="jQuote">Simple vector map</span>&quot;);
        header.setNotes(&quot;<span class="jQuote">Simple vector map containing a river, building and pump location.</span>&quot;);
        vectorMap.setHeader(header);
        
        <span class="jComment">// Find range of values and create a random colour table.</span>
        <span class="jPrimitive">float</span> min = vectorMap.getMinAttribute();
        <span class="jPrimitive">float</span> max = vectorMap.getMaxAttribute();
        vectorMap.setColourTable(ColourTable.getPresetColourTable(ColourTable.RANDOM,min,max));

        <span class="jComment">// Write new vector map to file.</span>
        LandSerfIO.write(vectorMap,&quot;<span class="jQuote">simple.vec</span>&quot;);
    }
}
</pre>
</td></tr></table>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

<p>
 Note the similarity with the way in which raster map metadata are added and saved to disk. The vector map that is created as 
 a result of this class is shown below.
</p>

<p>
<img src="images/figure3.2.png" width="508" height="497" align="bottom" alt="VectorMap output from the SimpleVectorMap class" />
<span class="caption">VectorMap output from the SimpleVectorMap class.</span>
</p>

<h2>3.3 Manipulating Vector Maps</h2>

<p>
 Vector maps can be read much as raster maps using the static method <code>LandSerfIO.readVector(<i>fileName</i>)</code>. Altering
 the metadata associated with a vector map is identical to that of a raster. To manipulate an individual <code>GISVector</code>
 within a vector map, the set of <code>GISVector</code>s contained can be iteratively extracted using the method <code>getGISVectors()</code>.
 This method (slightly unfortunately for naming purposes) returns a Java <code>Vector</code> of <code>GISVector</code>s. To process
 each object in turn, it would be normal to create an iterator:
</p>
 <pre>
 Iterator i = myVectorMap.getGISVectors().iterator();
 
 while (i.hasNext())
 {
     GISVector gisVect = (GISVector)i.next();
	 
     // Do something with each GISVector here.
 }
 </pre>

<p>
 Note that LandSerf 2.3 does not use generics to organise collections, so Java 1.5 'for-each' loops with generics cannot be used. Future
 releases of LandSerf will require Java 1.5 or above and will make use of generics for all collections.
</p>

<p>
 Depending on what you wish to do, it is sometime possible to avoid manipulating GISVector objects directly by calling 
 appropriate methods from the <code>VectorMap</code> object. The example below shows how two vector maps can be combined
 with simple <code>clone()</code> and <code>add()</code> methods.
</p>

<!-- ~~~~ Created using jFormat V2.4.1 ~~~~ -->
<table cellpadding="0" cellspacing="0"><tr>
<td valign="top">
<pre class="numbering">
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre>
</td>
<td valign="top">
<pre class="jSource">
<span class="jKeyword">import</span> jwo.landserf.structure.*;   <span class="jComment">// For spatial object class.</span>
<span class="jKeyword">import</span> jwo.landserf.process.io.*;  <span class="jComment">// For file handling.</span>

<span class="jComment">// **********************************************************</span>
<span class="jDocComment">/** Combines two vector maps by overlaying one on the other 
  * and creating new objects from their union. 
  * Demonstrates how the GISVector maps can be manipulated.
  * @author Jo Wood
  * @version 1.2, 16th October, 2007
  */</span>
<span class="jComment">// **********************************************************</span>

<span class="jKeyword">public</span> <span class="jKeyword">class</span> CombineVectors
{
    <span class="jComment">//------------------ Starter Method -----------------</span>
    
    <span class="jKeyword">public</span> <span class="jKeyword">static</span> <span class="jPrimitive">void</span> main(String[] args)
    {
        <span class="jKeyword">new</span> CombineVectors();
    }

    <span class="jComment">//------------------- Constructor -------------------</span>

    <span class="jKeyword">public</span> CombineVectors()
    {
        <span class="jComment">// Open an existing vector map.</span>
        VectorMap vectorMap1 = LandSerfIO.readVector(&quot;<span class="jQuote">simple.vec</span>&quot;);
        
        <span class="jComment">// Create a simple vector map to overlay over the first one.</span>
        VectorMap vectorMap2 = <span class="jKeyword">new</span> VectorMap();
        
        <span class="jPrimitive">float</span> triangleX[] = {6,11,2};
        <span class="jPrimitive">float</span> triangleY[] = {12,8,3};
        
        GISVector triangle = <span class="jKeyword">new</span> GISVector(triangleX,triangleY,SpatialModel.AREA,30);
        vectorMap2.add(triangle);
        
        <span class="jComment">// Add some simple metadata.</span>
        Header header = <span class="jKeyword">new</span> Header(&quot;<span class="jQuote">Triangular vector map</span>&quot;);
        header.setNotes(&quot;<span class="jQuote">Simple vector map containing a triangular GISVector.</span>&quot;);
        vectorMap2.setHeader(header);
       
        <span class="jComment">// Clone the first vector map and add the second to it.</span>
        VectorMap vectorMap3 = (VectorMap)vectorMap1.clone();
        vectorMap3.add(vectorMap2);
        
        vectorMap3.getHeader().setTitle(&quot;<span class="jQuote">Combined vector map</span>&quot;);
        vectorMap3.getHeader().setNotes(&quot;<span class="jQuote">Union of </span>&quot;+vectorMap1.getHeader().getTitle()+
                                        &quot;<span class="jQuote"> and </span>&quot;+vectorMap2.getHeader().getTitle());
       
        <span class="jPrimitive">float</span> min = vectorMap3.getMinAttribute();
        <span class="jPrimitive">float</span> max = vectorMap3.getMaxAttribute();
        vectorMap3.setColourTable(ColourTable.getPresetColourTable(ColourTable.RANDOM,min,max)); 
               
        <span class="jComment">// Write new vector map to file.</span>
        LandSerfIO.write(vectorMap3,&quot;<span class="jQuote">overlay.vec</span>&quot;);
    }
}
</pre>
</td></tr></table>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

<p>
 The output from this class is shown in LandSerf below:
 <br /><br />

<img src="images/figure3.3.png" width="508" height="497"" align="bottom" alt="VectorMap output from the CombineVectors class" />

<span class="caption">VectorMap output from the CombineVectors class.</span>

</p>


<h3>3.4 Exercises</h3>

<ol>

 <li>
  Write a class that reads in a vector map and separates the map into 'layers' of vector maps, each contining objects with
  the same attribute. To do this, you will need to iterate through each <code>GISVector</code> contained within the input
  map, identify its attribute, and then create a new vector map or add it to an existing one.
  <br /><br />
 </li>
 
 <li>
  Modify the <code>CombineVectors</code> class shown above so that it uses the existing colour tables of the combined
  vector maps (rather than creating a random one as above). You will have to consider what to do if the two vector maps 
  have different colours assigned to the same attribute value.
  <br /><br />
 </li>
  
</ol>

 <!-- Footer area -->
 <div id="footer">
  <div id="lastModified">Last Modified, 20th April, 2009</div>
 </div>

</div> <!-- End of container area -->
</body>
</html>